<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Snacks Point| Dashboard</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/food_app.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body class="body-bg">
    <!--Top Navigation-->
    <div class="row" >
      <!--Logo-->
      <div class="col-sm-2 mt-2 center d-none d-sm-block">
        <img src="images/logo2.jpg" alt="Snack Point" class="logo" >
      </div>
      <!--Logo-->
      <div class="col-sm-7 col-10 mt-5">
        <!--Navbar small screen-->
        <button type="button" class="btn btn-md btn-outline-danger dropdown-toggle d-inline d-sm-none" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
        </button>
        <ul class="dropdown-menu form-control">
          <li><a class="dropdown-item" href="dashboard.html"><i class="fa fa-angle-right" aria-hidden="true"></i> Dashboard</a></li>
          <li><a class="dropdown-item inactive" href="#"><i class="fa fa-angle-right" aria-hidden="true"></i> Your Orders</a></li>
          <li><a class="dropdown-item inactive" href="wishlist.html"><i class="fa fa-angle-right" aria-hidden="true"></i> Wishlist</a></li>
          <li><a class="dropdown-item inactive" href="#"><i class="fa fa-angle-right" aria-hidden="true"></i> Services</a></li>
          <li><a class="dropdown-item inactive" href="#"><i class="fa fa-angle-right" aria-hidden="true"></i> Checkout</a></li>
          <li><a class="dropdown-item inactive" href="#"><i class="fa fa-angle-right" aria-hidden="true"></i> About</a></li>
          <li><a class="dropdown-item inactive" href="#"><i class="fa fa-angle-right" aria-hidden="true"></i> Contact</a></li>
        </ul>
        <!--Navbar small screen-->

        <button class="btn btn-outline-danger btn-md  d-none d-sm-inline"><i class="fa fa-search" aria-hidden="true"></i> Search</button>
        <button class="btn btn-outline-danger btn-md  d-none d-sm-inline"><i class="fa fa-tag" aria-hidden="true"></i> Offers</button>
        <a href="cart.html" type="button" class="btn btn-outline-danger btn-md position-relative">
          <i class="fa fa-shopping-cart" aria-hidden="true"></i> Cart
          <span id="countOncart" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"></span>
        </a>
        <br>
        <!--Product Category name-->
        <div class="btn-group mt-30 col-12">
          <h2 id="product_category_name" class="d-none d-sm-block">Bread </h2>
        </div>
        <!--Product Category name-->
      </div>
      <div class="col-sm-3 col-2 mt-5">
        <div class="btn-group">
          <!--Visible on medium screen-->
          <button type="button" class="btn btn-md btn-outline-danger dropdown-toggle d-none d-sm-inline" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fa fa-user" aria-hidden="true"></i>
            <span id="uname" class="d-none d-sm-inline">Dexter Vin Catolos</span>
          </button>
          <!--Visible on medium screen-->
          <!--Visible on small screen-->
          <button type="button" class="btn btn-md btn-outline-danger dropdown-toggle d-inline d-sm-none" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fa fa-user" aria-hidden="true"></i>
          </button>
          <!--Visible on small screen-->
          <ul class="dropdown-menu form-control">
            <li><a class="dropdown-item" href="#">Profile</a></li>
            <li><a class="dropdown-item" href="#">Settings</a></li>
            <li><a class="dropdown-item" href="logout.html">Logout</a></li>
          </ul>
        </div>
      </div>
      <div  class=" m-2 col-12  d-block d-sm-none">
        <!--Search bar on small screen--> 
        <input class="form-control" type="text" placeholder="Search">
        <!--Search bar on small screen-->
        <!--Product Category on small screen-->
        <div>
          <button type="button" class="btn form-control btn-md btn-outline-danger dropdown-toggle d-inline d-sm-none mt-2"  data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fa fa-cutlery" aria-hidden="true"></i> <span id="product_category_name">Choose Category</span>
          </button>
          <ul id="categoryList1" class="dropdown-menu form-control">
          </ul>
        </div>
        
        <!--Product Category on small screen-->
      </div>
    </div>
    <!--Top Navigation--> 
    <!-- content -->
    <div class="container-fluid">
      <div class="row">
        <!-- Navbar Hidden on small screen-->
        <div class="col-md-2 d-none d-sm-block" >
          <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="dashboard.html" ><p> <i class="fa fa-angle-right" aria-hidden="true"></i> Dashbord</p></a>
            </li>
            <li class="nav-item">
                <a class="nav-link inactive" href="#"><p> <i class="fa fa-angle-right" aria-hidden="true"></i> Your Orders</p></a>
            </li>
            <li class="nav-item">
              <a class="nav-link inactive" href="wishlist.html">
                <p> 
                  <i class="fa fa-angle-right" aria-hidden="true"></i> 
                    Wishlist
                  <span class="badge bg-danger" style="font-size: 11px;">3</span>
                </p>
              </a>
            </li>
            <li class="nav-item">
                <a class="nav-link inactive" href="#"><p> <i class="fa fa-angle-right" aria-hidden="true"></i> Services</p></a>
            </li>
            <li class="nav-item">
                <a class="nav-link inactive" href="#"><p> <i class="fa fa-angle-right" aria-hidden="true"></i> Checkout</p></a>
            </li>
            <li class="nav-item">
                <a class="nav-link inactive" href="#"><p> <i class="fa fa-angle-right" aria-hidden="true"></i> About</p></a>
            </li>
            <li class="nav-item">
                <a class="nav-link inactive" href="#"><p> <i class="fa fa-angle-right" aria-hidden="true"></i> Contact</p></a>
            </li>
          </ul>
        </div>
        <!-- Navbar Hidden on small screen-->
        <!-- Product list -->
        <div id="productList" class="row col-sm-7 overflow-auto">
            <!-- Product images will be dynamically displayed here -->
        </div>
        <!-- Product list -->
        <!-- Product Categories -->
        <div class="col-sm-3 d-none d-sm-block">
            <h3>Product Categories</h3>        
            <ul id="categoryList2" class="nav flex-column">
                <!-- Populate Product Categories here-->
            </ul>
        </div>
        <!-- Product Categories -->
      </div>
    </div>
    <!-- content -->
  </body>
  <script>

  
  // Global variables
  let currentPage = 1; // Current page number
  const itemsPerPage = 6; // Number of items to display per page

  //Product Object---------------------------------------------------------------------------------------------
  let products = [
    {
      category: "All Products",
      items: [
        { productid: "1",image: "images/b5.jpg", name: "Croissants", price: 10.99, rating: 4.5 },
        { productid: "2",image: "images/b2.jpg", name: "Sausage roll", price: 8.99, rating: 3.8 },
        { productid: "3",image: "images/b3.jpg", name: "Viennoserie", price: 7.99, rating: 4.2 },
        { productid: "4",image: "images/b4.jpg", name: "Banana pie", price: 9.99, rating: 4.0 },
        { productid: "5",image: "images/b1.jpg", name: "Stromboli bread", price: 6.99, rating: 4.7 },
        { productid: "6",image: "images/p1.jpg", name: "Vegetarian Pizza", price: 12.99, rating: 4.8 },
        { productid: "7",image: "images/p2.jpg", name: "Behari chicken", price: 10.99, rating: 4.3 },
        { productid: "8",image: "images/p3.jpg", name: "Hawaiian Pizza", price: 11.99, rating: 4.6 },
        { productid: "9",image: "images/p4.jpg", name: "Afgani Tikka", price: 9.99, rating: 4.1 },
        { productid: "10",image: "images/p5.jpg", name: "Bacon Pizza", price: 13.99, rating: 4.9 },
        { productid: "11",image: "images/p6.jpg", name: "Chicken Supreme", price: 8.99, rating: 4.4 },
        { productid: "12",image: "images/p7.jpg", name: "Mushrooms Pizza", price: 7.99, rating: 4.2 },
        { productid: "13",image: "images/p8.jpg", name: "Chili pepper", price: 9.99, rating: 4.7 },
        { productid: "14",image: "images/p9.jpg", name: "mozzarela Pizza", price: 11.99, rating: 4.5 },
        { productid: "15",image: "images/p10.jpg", name: "Margherita Pizza", price: 10.99, rating: 4.3 },
        { productid: "16",image: "images/d1.jpg", name: "Mojito", price: 10.99, rating: 4.5 },
        { productid: "17",image: "images/d2.jpg", name: "Mimosa", price: 8.99, rating: 3.8 },
        { productid: "18",image: "images/d3.jpg", name: "Long Island Ice Tea", price: 7.99, rating: 4.2 },
        { productid: "19",image: "images/d4.jpg", name: "Strawberry Juice", price: 9.99, rating: 4.0 },
        { productid: "20",image: "images/d5.webp", name: "Tequilla Sunrise", price: 6.99, rating: 4.7 },
        { productid: "21",image: "images/d6.jpg", name: "Mai Tai", price: 12.99, rating: 4.8 },
        { productid: "22",image: "images/d7.jpg", name: "Milk Tea", price: 10.99, rating: 4.3 },
        { productid: "23",image: "images/d8.jpg", name: "Float", price: 11.99, rating: 4.6 },
        { productid: "24",image: "images/d9.jpg", name: "Ice Tea", price: 9.99, rating: 4.1 }
      ]
    },
    {
      category: "Bread",
      items: [
        { productid: "1",image: "images/b5.jpg", name: "Stromboli bread", price: 10.99, rating: 4.5 },
        { productid: "2",image: "images/b2.jpg", name: "Sausage roll", price: 8.99, rating: 3.8 },
        { productid: "3",image: "images/b3.jpg", name: "Viennoserie", price: 7.99, rating: 4.2 },
        { productid: "4",image: "images/b4.jpg", name: "Banana pie", price: 9.99, rating: 4.0 },
        { productid: "5",image: "images/b1.jpg", name: "Croissants", price: 6.99, rating: 4.7 },
      ]
    },
    {
      category: "Pizza",
      items: [
        { productid: "1",image: "images/p1.jpg", name: "Vegetarian Pizza", price: 12.99, rating: 4.8 },
        { productid: "2",image: "images/p2.jpg", name: "Behari chicken", price: 10.99, rating: 4.3 },
        { productid: "3",image: "images/p3.jpg", name: "Hawaiian Pizza", price: 11.99, rating: 4.6 },
        { productid: "4",image: "images/p4.jpg", name: "Afgani Tikka", price: 9.99, rating: 4.1 },
        { productid: "5",image: "images/p5.jpg", name: "Bacon Pizza", price: 13.99, rating: 4.9 },
        { productid: "6",image: "images/p6.jpg", name: "Chicken Supreme", price: 8.99, rating: 4.4 },
        { productid: "7",image: "images/p7.jpg", name: "Mushrooms Pizza", price: 7.99, rating: 4.2 },
        { productid: "18",image: "images/p8.jpg", name: "Chili pepper", price: 9.99, rating: 4.7 },
        { productid: "9",image: "images/p9.jpg", name: "mozzarela Pizza", price: 11.99, rating: 4.5 },
        { productid: "10",image: "images/p10.jpg", name: "Margherita Pizza", price: 10.99, rating: 4.3 },
        
      ]
    },
    {
      category: "Drinks",
      items: [
        { productid: "1",image: "images/d1.jpg", name: "Mojito", price: 10.99, rating: 4.5 },
        { productid: "2",image: "images/d2.jpg", name: "Mimosa", price: 8.99, rating: 3.8 },
        { productid: "3",image: "images/d3.jpg", name: "Long Island Ice Tea", price: 7.99, rating: 4.2 },
        { productid: "4",image: "images/d4.jpg", name: "Strawberry Juice", price: 9.99, rating: 4.0 },
        { productid: "5",image: "images/d5.webp", name: "Tequilla Sunrise", price: 6.99, rating: 4.7 },
        { productid: "6",image: "images/d6.jpg", name: "Mai Tai", price: 12.99, rating: 4.8 },
        { productid: "7",image: "images/d7.jpg", name: "Milk Tea", price: 10.99, rating: 4.3 },
        { productid: "8",image: "images/d8.jpg", name: "Float", price: 11.99, rating: 4.6 },
        { productid: "9",image: "images/d9.jpg", name: "Ice Tea", price: 9.99, rating: 4.1 }
      
      ]
    }
  ];
  //Product Object---------------------------------------------------------------------------------------------

  //Set product category---------------------------------------------------------------------------------------------
  // Set product category for small and medium screens
  let categoryList1 = document.getElementById("categoryList1");
  let categoryList2 = document.getElementById("categoryList2");

  // Get the product categories from the products object
  let product_categories = Object.keys(products);

  for (let i = 0; i < product_categories.length; i++) {
    (function(index) {
      let listItem1 = document.createElement("li");
      listItem1.classList.add("nav-item");

      let listItem2 = document.createElement("li");
      listItem2.classList.add("nav-item");

      let link1 = document.createElement("a");
      link1.href = "#";
      link1.classList.add("nav-category");
      link1.onclick = function() {
        choose_category(products[index].category);
      };

      let link2 = document.createElement("a");
      link2.href = "#";
      link2.classList.add("nav-category");
      link2.onclick = function() {
        choose_category(products[index].category);
      };

      let roundedDiv2 = document.createElement("div");
      roundedDiv2.classList.add("rounded-div");

      let image2 = document.createElement("img");
      image2.src = products[index].items[0].image; 
      image2.alt = "";

      let categoryName1 = document.createElement("h6");
      categoryName1.classList.add("category_name");
      categoryName1.textContent = products[index].category;

      let categoryName2 = document.createElement("h6");
      categoryName2.classList.add("category_name");
      categoryName2.textContent = products[index].category;

      link1.appendChild(categoryName1);
      listItem1.appendChild(link1);
      categoryList1.appendChild(listItem1);

      roundedDiv2.appendChild(image2);
      link2.appendChild(roundedDiv2);
      link2.appendChild(categoryName2);
      listItem2.appendChild(link2);
      categoryList2.appendChild(listItem2);
    })(i);
  }
  //Set product category---------------------------------------------------------------------------------------------

  //display name of current logged in user---------------------------------------------------------------------------
  let logged_in_user = localStorage.getItem('username');
  document.getElementById("uname").innerHTML =logged_in_user;
  //display name of current logged in user---------------------------------------------------------------------------
  
  window.onload = function() {
    //Set default product category---------------------------------------------------------------------------
    // Set the default category and call the choose_category function
    let defaultCategory = "All Products";
    choose_category(defaultCategory);

    //Check Cart on page load---------------------------------------------------------------------------
    checkCart()
  };

  //Function CheckCart---------------------------------------------------------------------------
  function checkCart(){

    let productOncart = JSON.parse(localStorage.getItem('itemOncart'));
    let totalQuantity = 0;

    // Count products added to cart and display total to UI
    if (productOncart !== null) {
      productOncart.items.forEach(item => {
        totalQuantity += item.quantity;
      });
      document.getElementById("countOncart").innerHTML =totalQuantity;
    }else{
      document.getElementById("countOncart").innerHTML ='';
    }

  }
  //Function CheckCart---------------------------------------------------------------------------

  // Add product to cart-------------------------------------------------------------------------
  function addtocart(productid, category,image, name, price, rating) {
    
    let productOncart = JSON.parse(localStorage.getItem('itemOncart')) || {};

    let pid = productid;
    let prodcategory = category;
    let pname = name;
    let pimage = image;
    let pprice = price;
    let prating = rating;
    let pquantity = 1;

    let productItem = { productid: pid, category: prodcategory, image: pimage, name: pname,  price: pprice, rating: prating, quantity: pquantity};

    if (!productOncart.items) {
      productOncart.items = [];
    }

     // Check if a similar object already exists
    let similarObjectIndex = productOncart.items.findIndex(item => {
      return (
        item.productid === pid && item.category === prodcategory
      );
    });

    if (similarObjectIndex !== -1) {
      // Similar object exists, update quantity
      productOncart.items[similarObjectIndex].quantity++;

      // Update the corresponding object in localStorage
      localStorage.setItem('itemOncart', JSON.stringify(productOncart));
    } else {
      productOncart.items.push(productItem);
      localStorage.setItem('itemOncart', JSON.stringify(productOncart));
    }

   checkCart()
   
  }
  // Add product to cart-------------------------------------------------------------------------

  //onclick heart icon---------------------------------------------------------------------------
  function toggleFavorite(status,id) {
    let button = document.getElementById(id);
    let heartIcon = button.getElementsByTagName("i")[0];

    if (status === "add") {

      button.onclick = function () {
        toggleFavorite('remove',this.id);
      };// Add to favorite
      
      button.classList.remove("btn-light");
      button.classList.add("btn-danger");

    } else if (status === "remove") {

      button.onclick = function () {
        toggleFavorite('add',this.id);
      };// Remove from favorite

      button.classList.remove("btn-danger");
      button.classList.add("btn-light");
    }
  }
  //onclick heart icon---------------------------------------------------------------------------

  //Pagination-----------------------------------------------------------------------------------
  function togglepage(id,category) {

    let selectedLink = document.getElementById(id);
    let paginationLinks = document.getElementsByClassName("pagination-link");

    for (let link of paginationLinks) {
      link.classList.remove("active");
    }

    choose_category(category);

    selectedLink.classList.add("active");

  }
  //Pagination------------------------------------------------------------------------------------

  //toggle product categories------------------------------------------------------------------------
  function choose_category(category) {
    
    //display category name
    document.getElementById('product_category_name').innerHTML = category;

    // populate products with the chosen category
    let productList = document.getElementById("productList");
    productList.innerHTML = ""; // Clear the existing product list
    

    let selectedCategory = products.find(item => item.category === category); //find products from the objects with the chosen category

    if (selectedCategory) {

      let items = selectedCategory.items;

      // Setup pagination variables-----------------------------------------------------------------
      // Calculate the starting and ending index of the items to display for the current page
      let startIndex = (currentPage - 1) * itemsPerPage;
      let endIndex = startIndex + itemsPerPage;
      currentPage = 1;
      // Setup pagination variables-----------------------------------------------------------------

      // Display products---------------------------------------------------------------------------

      for (let i = startIndex; i < endIndex && i < items.length; i++) {
        //Product container
        let colDiv = document.createElement("div");
        colDiv.classList.add("col-sm-3","product_container");

        let buttonDiv = document.createElement("div");
        buttonDiv.classList.add("product_container_btn");
        //star rating icon
        let starButton = document.createElement("button");
        starButton.classList.add("btn", "btn-sm", "btn-dark", "disabled","rating_btn");
        starButton.innerHTML = '<i class="fa fa-star"></i> ' + items[i].rating;
        //heart icon for favorites
        let heartButton = document.createElement("button");
        heartButton.setAttribute("id", "favorite" + i);
        heartButton.classList.add("btn", "btn-sm", "btn-light","favorite_btn");
        heartButton.innerHTML = '<i class="fa fa-heart-o"></i>';
        heartButton.onclick = function() {
        toggleFavorite('add', this.id);
        };

        buttonDiv.appendChild(starButton);
        buttonDiv.appendChild(heartButton);

        let imgDiv = document.createElement("div");
        imgDiv.classList.add("product");
        //product image
        let img = document.createElement("img");
        img.src = items[i].image;
        img.alt = "product_img";

        imgDiv.appendChild(img);
        //product details
        let textDiv = document.createElement("div");
        textDiv.classList.add("product_details");

        let h5 = document.createElement("h5");
        h5.textContent = items[i].name;

        let label = document.createElement("label");
        label.textContent = "Price: $" + items[i].price.toFixed(2);

        let br = document.createElement("br");
        //add to cart button
        let addbutton = document.createElement("button");
        addbutton.setAttribute("id", items[i].productid);
        addbutton.classList.add("btn", "btn-sm", "btn-danger", "form-control", "mt-1");
        addbutton.onclick = function() {
          addtocart(this.id,category,items[i].image,items[i].name,items[i].price,items[i].rating);
        };
        addbutton.innerHTML = '<i class="fa fa-cart-plus"></i> Add to cart';

        textDiv.appendChild(h5);
        textDiv.appendChild(label);
        textDiv.appendChild(br);
        textDiv.appendChild(addbutton);

        colDiv.appendChild(buttonDiv);
        colDiv.appendChild(imgDiv);
        colDiv.appendChild(textDiv);

        productList.appendChild(colDiv);
      }
      // Create pagination links----------------------------------------------------------------
      let totalPages = Math.ceil(items.length / itemsPerPage);
      let paginationDiv = document.createElement("div");
      paginationDiv.classList.add("pagination",);

      for (let i = 1; i <= totalPages; i++) {
        let pageLink = document.createElement("a");
        pageLink.href = "#";
        pageLink.textContent = i;
        pageLink.classList.add("pagination-link");
        pageLink.setAttribute("id", "pagination-link-" + i);
        pageLink.onclick = function () {
        currentPage = i; // Update the current page
          togglepage("pagination-link-" + i, category);
        };

        paginationDiv.appendChild(pageLink);
      }
      // Create pagination links----------------------------------------------------------------

      productList.appendChild(paginationDiv);
    
    }
  }
  // Display products---------------------------------------------------------------------------

  </script>
</html>
